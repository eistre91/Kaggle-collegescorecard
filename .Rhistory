?kmeans
ggplot(ten_earnings) +
geom_jitter(aes(color=as.factor(2), x=admission_rate.overall, y=X10_yrs_after_entry.median), alpha = .75, width = .5, height = .5) +
scale_y_continuous(limits = c(15000,75000)) +
scale_x_continuous(limits = c(0.01, 0.99), breaks = seq(.2, 1, .2), minor_breaks = seq(.1,.9,.2)) +
annotate("rect", xmin=.3, xmax=.99, ymin=15000, ymax=75000, alpha=.25, fill="yellow") +
scale_color_few() +
guides(color=FALSE)
library(ggplot2)
library(ggthemes)
library(dplyr)
library(RSQLite)
library(gridExtra)
library(ggvis)
my_db <- src_sqlite("database.sqlite")
tbl <- tbl(my_db, "Scorecard")
data_dictionary <- read.csv("CollegeScorecardDataDictionary-09-12-2015.csv")
setwd("C:/Kaggle-collegescorecard/")
theme_set(theme_few())
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
my_db <- src_sqlite("database.sqlite")
tbl <- tbl(my_db, "Scorecard")
data_dictionary <- read.csv("CollegeScorecardDataDictionary-09-12-2015.csv")
theme_set(theme_few())
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
trim <- select(tbl, md_earn_wne_p10, C150_4_POOLED, C150_L4_POOLED, C200_4_POOLED, C200_L4_POOLED, C150_4_POOLED_SUPP, C150_L4_POOLED_SUPP, C200_4_POOLED_SUPP, C200_L4_POOLED_SUPP, PFTFTUG1_EF, PPTUG_EF, UGDS, PCIP01:PCIP54, CCBASIC:CCSIZSET, NPT4_PUB, NPT4_PRIV, COSTT4_A:TUITIONFEE_PROG, TUITFTE:PFTFAC, UNITID:LONGITUDE, Year, ADM_RATE, ACTCMMID, SAT_AVG, PCTFLOAN, PCTPELL, GRAD_DEBT_MDN, GRAD_DEBT_MDN_SUPP, WDRAW_DEBT_MDN, CURROPER, DISTANCEONLY, COMP_ORIG_YR2_RT:ENRL_2YR_TRANS_YR2_RT, COMP_ORIG_YR3_RT:ENRL_2YR_TRANS_YR3_RT, COMP_ORIG_YR4_RT:ENRL_2YR_TRANS_YR4_RT, COMP_ORIG_YR6_RT:ENRL_2YR_TRANS_YR6_RT, COMP_ORIG_YR8_RT:ENRL_2YR_TRANS_YR8_RT )
trim <- collect(trim)
current_colnames <- colnames(trim)
for(i in 1:length(current_colnames)) {
location <- which(data_dictionary$VARIABLE.NAME == current_colnames[i])
if(length(location) == 0) {next}
new_name <- as.character(data_dictionary[location, 4])
if(new_name != "") {current_colnames[i] <- new_name}
}
current_colnames <- make.names(current_colnames, unique = TRUE)
colnames(trim) <- current_colnames
trim <- trim %>% filter(state %in% c("AL", "AK", "AZ", "CA", "CO", "CT", "DE", "DC", "FL", "GA", "HI", "ID", "IL", "IN", "IA", "KS", "AR", "KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX", "UT", "VT", "VA", "WA", "WV", "WI", "WY"))
fill_in <- trim %>% filter(Year == 2013) %>% select(name, carnegie_basic)
for(id in 1:nrow(fill_in)) {
trim$carnegie_basic[trim$name %in% fill_in$name[id]] <- fill_in$carnegie_basic[id]
#trim
}
ten <- trim %>% filter(Year %in% c(2007, 2009, 2011))
ten_earnings <- ten %>% filter(!is.na(X10_yrs_after_entry.median), X10_yrs_after_entry.median > 0)
options(scipen=10000)
ggplot(ten_earnings) +
geom_jitter(aes(color=as.factor(2), x=admission_rate.overall, y=X10_yrs_after_entry.median), alpha = .75, width = .5, height = .5) +
scale_y_continuous(limits = c(15000,75000)) +
scale_x_continuous(limits = c(0.01, 0.99), breaks = seq(.2, 1, .2), minor_breaks = seq(.1,.9,.2)) +
annotate("rect", xmin=.3, xmax=.99, ymin=15000, ymax=75000, alpha=.25, fill="yellow") +
scale_color_few() +
guides(color=FALSE) +
xlab("Percentage of Students Admitted") +
ylab("Median Earnings after 10 Years")
ggplot(ten_earnings) +
geom_jitter(aes(color=as.factor(2), x=admission_rate.overall, y=X10_yrs_after_entry.median), alpha = .75, width = .5, height = .5) +
scale_y_continuous(limits = c(15000,75000)) +
scale_x_continuous(limits = c(0.01, 0.99), breaks = seq(.2, 1, .2), minor_breaks = seq(.1,.9,.2)) +
annotate("rect", xmin=.3, xmax=.99, ymin=15000, ymax=60000, alpha=.25, fill="yellow") +
scale_color_few() +
guides(color=FALSE) +
xlab("Percentage of Students Admitted") +
ylab("Median Earnings after 10 Years")
ten_earnings$median_debt.completers.overall
earnings_debt <- ten_earnings %>% filter(!is.na(median_debt.completers.overall), median_debt.completers.overall > 0)
earnings_debt
earnings_debt$median_debt.completers.overall
earnings_debt <- earnings_debt %>% mutate(earnings_debt_ratio = X10_yrs_after_entry.median/median_debt.completers.overall)
earnings_debt
ggplot(earnings_debt) +
geom_jitter(aes(x=admission_rate.overall, y=earnings_debt_ratio))
ggplot(earnings_debt) +
geom_jitter(aes(x=admission_rate.overall, y=earnings_debt_ratio)) +
scale_y_continuous(limits = c(0,20))
ggplot(earnings_debt) +
geom_jitter(aes(x=admission_rate.overall, y=earnings_debt_ratio)) +
scale_y_continuous(limits = c(10,20)) +
scale_x_continuous(limits = c(0.01,0.99))
ggplot(earnings_debt) +
geom_jitter(aes(x=admission_rate.overall, y=earnings_debt_ratio)) +
scale_y_continuous(limits = c(0,20)) +
scale_x_continuous(limits = c(0.01,0.99))
ggplot(earnings_debt) +
geom_jitter(aes(x=admission_rate.overall, y=earnings_debt_ratio)) +
scale_y_continuous(limits = c(0,10)) +
scale_x_continuous(limits = c(0.01,0.99))
ggplot(earnings_debt) +
geom_jitter(aes(x=admission_rate.overall, y=earnings_debt_ratio)) +
scale_y_continuous(limits = c(0,5)) +
scale_x_continuous(limits = c(0.01,0.99))
ggplot(earnings_debt) +
cor(earnings_debt$tuition.out_of_state, earnings_debt$X10_yrs_after_entry.median)
cor(earnings_debt$tuition.out_of_state, earnings_debt$X10_yrs_after_entry.median, use="complete.obs")
cor(earnings_debt$tuition.out_of_state, earnings_debt$median_debt.completers.overall, use="complete.obs")
cor(earnings_debt$tuition.in_state, earnings_debt$X10_yrs_after_entry.median, use="complete.obs")
cor(earnings_debt$tuition.in_state, earnings_debt$median_debt.completers.overall, use="complete.obs")
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=earnings_debt$X10_yrs_after_entry.median))
cor(earnings_debt$tuition.out_of_state, earnings_debt$earnings_debt_ratio, use="complete.obs")
cor(earnings_debt$tuition.in_state, earnings_debt$earnings_debt_ratio, use="complete.obs")
?lm
test_model <- lm(X10_yrs_after_entry.median ~ tuition.out_of_state, earnings_debt, na.action = na.omit)
summary(test_model)
test_model <- lm(earnings_debt_ratio ~ tuition.out_of_state, earnings_debt, na.action = na.omit)
summary(test_model)
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=earnings_debt_ratio))
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=earnings_debt_ratio)) +
scale_y_continuous(limits=c(0,10))
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=median_debt.completers.overall))
high_test_scores <- filter(ten_earnings,
act_scores.midpoint.cumulative > quantile(ten_earnings$act_scores.midpoint.cumulative, prob=.9, na.rm=TRUE) |
sat_scores.average.overall > quantile(ten_earnings$sat_scores.average.overall, prob=.9, na.rm=TRUE)
)
regular_test_scores <- filter(ten_earnings,
( act_scores.midpoint.cumulative < quantile(ten_earnings$act_scores.midpoint.cumulative, prob=.9, na.rm=TRUE) &
act_scores.midpoint.cumulative > quantile(ten_earnings$act_scores.midpoint.cumulative, prob=.1, na.rm=TRUE) )
|
( sat_scores.average.overall < quantile(ten_earnings$sat_scores.average.overall, prob=.9, na.rm=TRUE) &
sat_scores.average.overall > quantile(ten_earnings$sat_scores.average.overall, prob=.1, na.rm=TRUE) )
)
numeric_ten_earnings <- ten_earnings[ ,sapply(ten_earnings, is.numeric)]
correlation_matrix <- cor(numeric_ten_earnings, use="pairwise.complete.obs")
low_correlation_columns <- names(correlation_matrix[correlation_matrix[,"X10_yrs_after_entry.median"] < .3, "X10_yrs_after_entry.median"])
more_correlated <- select(ten_earnings, -one_of(low_correlation_columns))
more_correlated
correlation_matrix
correlation_matrix[correlation_matrix[,"X10_yrs_after_entry.median"] > .3, "X10_yrs_after_entry.median"]
numeric_ten_earnings <- ten_earnings[ ,sapply(ten_earnings, is.numeric)]
correlation_matrix <- cor(numeric_ten_earnings, use="pairwise.complete.obs")
low_correlation_columns <- names(correlation_matrix[correlation_matrix[,"X10_yrs_after_entry.median"] < .3, "X10_yrs_after_entry.median"])
more_correlated <- select(ten_earnings, -one_of(low_correlation_columns))
numeric_high_test_scores <- high_test_scores[ ,sapply(high_test_scores, is.numeric)]
high_correlation_matrix <- cor(numeric_high_test_scores, use="pairwise.complete.obs")
high_correlation_matrix[high_correlation_matrix[,"X10_yrs_after_entry.median"] > .3, "X10_yrs_after_entry.median"]
numeric_regular_test_scores <- regular_test_scores[ ,sapply(regular_test_scores, is.numeric)]
regular_correlation_matrix <- cor(numeric_regular_test_scores, use="pairwise.complete.obs")
regular_correlation_matrix[regular_correlation_matrix[,"X10_yrs_after_entry.median"] > .3 & !is.na(regular_correlation_matrix[, "X10_yrs_after_entry.median"]), "X10_yrs_after_entry.median"]
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=earnings_debt_ratio)) +
scale_y_continuous(limits=c(0,10))
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=median_debt.completers.overall))
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=median_debt.completers.overall)) +
geom_jitter(aes(x=tuition.in_state, y=median_debt.completers.overall, color=as.factor(1)))
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=median_debt.completers.overall, color=as.factor(1))) +
geom_jitter(aes(x=tuition.in_state, y=median_debt.completers.overall, color=as.factor(1)))
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=median_debt.completers.overall, color=cbPalette[1])) +
geom_jitter(aes(x=tuition.in_state, y=median_debt.completers.overall, color=as.factor(1)))
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=median_debt.completers.overall, color=cbPalette[2])) +
geom_jitter(aes(x=tuition.in_state, y=median_debt.completers.overall, color=as.factor(1)))
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=median_debt.completers.overall, color=cbPalette)) +
geom_jitter(aes(x=tuition.in_state, y=median_debt.completers.overall, color=as.factor(1)))
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.in_state, y=median_debt.completers.overall, color=as.factor(1)))
geom_jitter(aes(x=tuition.out_of_state, y=median_debt.completers.overall, color=cbPalette[1])) +
ggplot(earnings_debt) +
ggplot(earnings_debt) +
geom_jitter(aes(x=tuition.out_of_state, y=median_debt.completers.overall, color=cbPalette[1])) +
geom_jitter(aes(x=tuition.in_state, y=median_debt.completers.overall, color=as.factor(1)))
cor(earnings_debt$tuition.out_of_state, earnings_debt$median_debt.completers.overall, use="complete.obs")
cor(earnings_debt$tuition.in_state, earnings_debt$median_debt.completers.overall, use="complete.obs")
ggplot(earnings_debt) +
geom_jitter(aes(x=median_debt.completers.overall, y=X10_yrs_after_entry.median))
cor(earnings_debt$median_debt.completers.overall, earnings_debt$X10_yrs_after_entry.median, use="complete.obs")
cor(earnings_debt$median_debt.completers.overall, earnings_debt$X10_yrs_after_entry.median, use="complete.obs")
cor(regular_test_scores$median_debt.completers.overall, regular_test_scores$median_debt.completers.overall)
cor(regular_test_scores$median_debt.completers.overall, regular_test_scores$median_debt.completers.overall, use="complete.obs")
cor(regular_test_scores$median_debt.completers.overall, regular_test_scores$X10_yrs_after_entry.median, use="complete.obs")
ggplot(regular_test_scores) +
geom_jitter(aes(x=median_debt.completers.overall, y=X10_yrs_after_entry.median))
regular_test_scores <- filter(earnings_debt,
( act_scores.midpoint.cumulative < quantile(ten_earnings$act_scores.midpoint.cumulative, prob=.9, na.rm=TRUE) &
act_scores.midpoint.cumulative > quantile(ten_earnings$act_scores.midpoint.cumulative, prob=.1, na.rm=TRUE) )
|
( sat_scores.average.overall < quantile(ten_earnings$sat_scores.average.overall, prob=.9, na.rm=TRUE) &
sat_scores.average.overall > quantile(ten_earnings$sat_scores.average.overall, prob=.1, na.rm=TRUE) )
)
ggplot(regular_test_scores) +
geom_jitter(aes(x=median_debt.completers.overall, y=X10_yrs_after_entry.median))
quantile(ten_earnings$act_scores.midpoint.cumulative, prob=.9, na.rm=TRUE)
quantile(ten_earnings$act_scores.midpoint.cumulative, prob=.1, na.rm=TRUE)
quantile(ten_earnings$sat_scores.average.overall, prob=.9, na.rm=TRUE)
quantile(ten_earnings$sat_scores.average.overall, prob=.1, na.rm=TRUE)
quantile(ten_earnings$sat_scores.average.overall, prob=.99, na.rm=TRUE)
quantile(ten_earnings$act_scores.midpoint.cumulative, prob=.9, na.rm=TRUE)
quantile(ten_earnings$act_scores.midpoint.cumulative, prob=.1, na.rm=TRUE)
quantile(ten_earnings$sat_scores.average.overall, prob=.9, na.rm=TRUE)
quantile(ten_earnings$sat_scores.average.overall, prob=.1, na.rm=TRUE)
ggplot(regular_test_scores) +
geom_jitter(aes(x=median_debt.completers.overall, y=X10_yrs_after_entry.median)) +
scale_x_continuous(limits=c(10000, 30000)) +
scale_y_continuous(limits=c(15000,75000))
ggplot(regular_test_scores) +
geom_jitter(aes(x=median_debt.completers.overall, y=X10_yrs_after_entry.median), color="yellow") +
scale_x_continuous(limits=c(10000, 30000)) +
scale_y_continuous(limits=c(15000,75000))
geom_jitter(aes(x=median_debt.completers.overall, y=X10_yrs_after_entry.median)) +
ggplot(regular_test_scores) +
geom_jitter(aes(x=median_debt.completers.overall, y=X10_yrs_after_entry.median)) +
scale_x_continuous(limits=c(10000, 30000)) +
scale_y_continuous(limits=c(15000,75000)) +
scale_color_few()
ggplot(regular_test_scores) +
geom_jitter(aes(x=median_debt.completers.overall, y=X10_yrs_after_entry.median)) +
scale_x_continuous(limits=c(10000, 30000)) +
scale_y_continuous(limits=c(15000,75000)) +
scale_color_few()
ggplot(regular_test_scores) +
geom_jitter(aes(x=median_debt.completers.overall, y=X10_yrs_after_entry.median, color=as.factor(1))) +
scale_y_continuous(limits=c(15000,75000)) +
scale_x_continuous(limits=c(10000, 30000)) +
scale_color_few() +
guides(color=FALSE)
ggplot(regular_test_scores) +
geom_jitter(aes(x=median_debt.completers.overall, y=X10_yrs_after_entry.median, color=as.factor(1))) +
scale_x_continuous(limits=c(10000, 30000)) +
scale_y_continuous(limits=c(15000,75000)) +
scale_color_few() +
guides(color=FALSE) +
xlab("Median Debt Accrued by Graduated Students") +
ylab("Median Earnings after 10 Years")
relative <- read.csv("relativevalue.csv", skipNul = TRUE)
colnames(relative) <- c("state", "relative")
relative <- inner_join(with_median, relative)
mytheme <- ttheme_default(core = list(fg_params=list(cex = 2.0)))
myt <- gridExtra::tableGrob(relative, theme = mytheme)
grid.table(relative)
relative_display <- select(relative, State = state, "Relative Value of $100" = relative)
left <- tableGrob(relative_display[1:17,], rows = 1:17)
middle <- tableGrob(relative_display[18:34,], rows = 18:34)
right <- tableGrob(relative_display[35:51,], rows = 35:51)
grid.arrange(left, middle, right, ncol=3)
regular_correlation_matrix[regular_correlation_matrix[,"X10_yrs_after_entry.median"] > .3 & !is.na(regular_correlation_matrix[, "X10_yrs_after_entry.median"]), "X10_yrs_after_entry.median"]
correlation_matrix[correlation_matrix[,"X10_yrs_after_entry.median"] > .3 & !is.na(correlation_matrix[, "X10_yrs_after_entry.median"]), "X10_yrs_after_entry.median"]
correlation_matrix[correlation_matrix[,"X10_yrs_after_entry.median"] < .3 & !is.na(correlation_matrix[, "X10_yrs_after_entry.median"]), "X10_yrs_after_entry.median"]
state_earnings <- ten_earnings %>%
select(median_earnings = X10_yrs_after_entry.median,
p25_earnings = pct25_earn_wne_p10,
p75_earnings = pct75_earn_wne_p10,
state,
admission_rate.overall)
with_median <- state_earnings %>% group_by(state) %>% summarise(median_median = median(median_earnings))
state_earnings <- mutate(state_earnings, median_median = 0)
for(i in 1:nrow(with_median)) {
state_earnings$median_median[state_earnings$state == with_median[[i,1]]] <- with_median[[i,2]]
}
state_earnings <- state_earnings %>% arrange(median_median)
ggplot(aes(x = state), data = state_earnings) +
geom_boxplot(aes(y = median_earnings, fill=cbPalette[2], label=state), outlier.shape=NA, coef=0) +
scale_x_discrete(limits=unique(state_earnings$state)) +
guides(fill=FALSE) +
geom_text(data=with_median, aes(x=state, label=state, y=median_median-1000), nudge_x=.1, size=3) +
theme(axis.text.y = element_blank()) +
xlab("State") +
ylab("Median Earnings After 10 Years") +
coord_flip(ylim=c(20000,60000))
state_earnings <- ten_earnings %>%
select(median_earnings = X10_yrs_after_entry.median,
state,
admission_rate.overall)
with_median <- state_earnings %>% group_by(state) %>% summarise(median_median = median(median_earnings))
state_earnings <- mutate(state_earnings, median_median = 0)
for(i in 1:nrow(with_median)) {
state_earnings$median_median[state_earnings$state == with_median[[i,1]]] <- with_median[[i,2]]
}
state_earnings <- state_earnings %>% arrange(median_median)
ggplot(aes(x = state), data = state_earnings) +
geom_boxplot(aes(y = median_earnings, fill=cbPalette[2], label=state), outlier.shape=NA, coef=0) +
scale_x_discrete(limits=unique(state_earnings$state)) +
guides(fill=FALSE) +
geom_text(data=with_median, aes(x=state, label=state, y=median_median-1000), nudge_x=.1, size=3) +
theme(axis.text.y = element_blank()) +
xlab("State") +
ylab("Median Earnings After 10 Years") +
coord_flip(ylim=c(20000,60000))
ggplot(aes(x = state), data = state_earnings) +
geom_boxplot(aes(y = median_earnings, fill=cbPalette[2], label=state), outlier.shape=NA, coef=0) +
scale_x_discrete(limits=unique(state_earnings$state)) +
guides(fill=FALSE) +
geom_text(data=with_median, aes(x=state, label=state, y=median_median-2500), nudge_x=.1, size=3) +
theme(axis.text.y = element_blank()) +
xlab("State") +
ylab("Median Earnings After 10 Years") +
coord_flip(ylim=c(20000,60000))
state_earnings <- state_earnings %>% mutate(relative_value = 0)
for(i in 1:nrow(with_median)) {
state_earnings$relative_value[state_earnings$state == relative[[i,1]]] <- relative[[i,3]]
}
state_earnings <- state_earnings %>% mutate(adjusted_earnings = 0)
state_earnings <- state_earnings %>% mutate(adjusted_earnings = (median_earnings)*(relative_value/100))
with_median <- state_earnings %>% group_by(state) %>% summarise(median_adjusted = median(adjusted_earnings))
state_earnings <- mutate(state_earnings, median_adjusted = 0)
for(i in 1:nrow(with_median)) {
state_earnings$median_adjusted[state_earnings$state == with_median[[i,1]]] <- with_median[[i,2]]
}
state_earnings <- state_earnings %>% arrange(median_adjusted)
ggplot(aes(x = state), data = state_earnings) +
geom_boxplot(aes(y = adjusted_earnings, fill=cbPalette[2]), outlier.shape=NA, coef=0) +
scale_x_discrete(limits=unique(state_earnings$state)) +
guides(fill=FALSE) +
geom_text(data=with_median, aes(x=state, label=state, y=median_adjusted-1000), nudge_x=.1, size=3) +
theme(axis.text.y = element_blank()) +
xlab("State") +
ylab("Adjusted Median Earnings After 10 Years") +
coord_flip(ylim=c(20000,60000))
ggplot(aes(x = state), data = state_earnings) +
geom_boxplot(aes(y = adjusted_earnings, fill=cbPalette[2]), outlier.shape=NA, coef=0) +
scale_x_discrete(limits=unique(state_earnings$state)) +
guides(fill=FALSE) +
geom_text(data=with_median, aes(x=state, label=state, y=median_adjusted-1500), nudge_x=.1, size=3) +
theme(axis.text.y = element_blank()) +
xlab("State") +
ylab("Adjusted Median Earnings After 10 Years") +
coord_flip(ylim=c(20000,60000))
```
state_earnings
relative
state_earnings <- state_earnings %>% mutate(relative_value = 0)
for(i in 1:nrow(with_median)) {
state_earnings$relative_value[state_earnings$state == relative[[i,1]]] <- relative[[i,3]]
}
relative
state_earnings <- state_earnings %>% mutate(relative_value = 0)
for(i in 1:nrow(with_median)) {
state_earnings$relative_value[state_earnings$state == relative[[i,1]]] <- relative[[i,2]]
}
state_earnings <- state_earnings %>% mutate(adjusted_earnings = 0)
state_earnings <- state_earnings %>% mutate(adjusted_earnings = (median_earnings)*(relative_value/100))
with_median <- state_earnings %>% group_by(state) %>% summarise(median_adjusted = median(adjusted_earnings))
state_earnings <- mutate(state_earnings, median_adjusted = 0)
for(i in 1:nrow(with_median)) {
state_earnings$median_adjusted[state_earnings$state == with_median[[i,1]]] <- with_median[[i,2]]
}
state_earnings <- state_earnings %>% arrange(median_adjusted)
ggplot(aes(x = state), data = state_earnings) +
geom_boxplot(aes(y = adjusted_earnings, fill=cbPalette[2]), outlier.shape=NA, coef=0) +
scale_x_discrete(limits=unique(state_earnings$state)) +
guides(fill=FALSE) +
geom_text(data=with_median, aes(x=state, label=state, y=median_adjusted-1500), nudge_x=.1, size=3) +
theme(axis.text.y = element_blank()) +
xlab("State") +
ylab("Adjusted Median Earnings After 10 Years") +
coord_flip(ylim=c(20000,60000))
?grid.arrange
unadjusted <- ggplot(aes(x = state), data = state_earnings) +
geom_boxplot(aes(y = median_earnings, fill=cbPalette[2], label=state), outlier.shape=NA, coef=0) +
scale_x_discrete(limits=unique(state_earnings$state)) +
guides(fill=FALSE) +
geom_text(data=with_median, aes(x=state, label=state, y=median_median-1500), nudge_x=.1, size=3) +
theme(axis.text.y = element_blank()) +
xlab("State") +
ylab("Median Earnings After 10 Years") +
coord_flip(ylim=c(20000,60000))
adjusted <- ggplot(aes(x = state), data = state_earnings) +
geom_boxplot(aes(y = adjusted_earnings, fill=cbPalette[2]), outlier.shape=NA, coef=0) +
scale_x_discrete(limits=unique(state_earnings$state)) +
guides(fill=FALSE) +
geom_text(data=with_median, aes(x=state, label=state, y=median_adjusted-1500), nudge_x=.1, size=3) +
theme(axis.text.y = element_blank()) +
xlab("State") +
ylab("Adjusted Median Earnings After 10 Years") +
coord_flip(ylim=c(20000,60000))
grid.arrange(unadjusted, adjusted, ncol=1)
state_earnings <- ten_earnings %>%
select(median_earnings = X10_yrs_after_entry.median,
state,
admission_rate.overall)
with_median <- state_earnings %>% group_by(state) %>% summarise(median_median = median(median_earnings))
state_earnings <- mutate(state_earnings, median_median = 0)
for(i in 1:nrow(with_median)) {
state_earnings$median_median[state_earnings$state == with_median[[i,1]]] <- with_median[[i,2]]
}
state_earnings <- state_earnings %>% arrange(median_median)
unadjusted <- ggplot(aes(x = state), data = state_earnings) +
geom_boxplot(aes(y = median_earnings, fill=cbPalette[2], label=state), outlier.shape=NA, coef=0) +
scale_x_discrete(limits=unique(state_earnings$state)) +
guides(fill=FALSE) +
geom_text(data=with_median, aes(x=state, label=state, y=median_median-1500), nudge_x=.1, size=3) +
theme(axis.text.y = element_blank()) +
xlab("State") +
ylab("Median Earnings After 10 Years") +
coord_flip(ylim=c(20000,60000))
state_earnings <- state_earnings %>% mutate(relative_value = 0)
for(i in 1:nrow(with_median)) {
state_earnings$relative_value[state_earnings$state == relative[[i,1]]] <- relative[[i,2]]
}
state_earnings <- state_earnings %>% mutate(adjusted_earnings = 0)
state_earnings <- state_earnings %>% mutate(adjusted_earnings = (median_earnings)*(relative_value/100))
with_median <- state_earnings %>% group_by(state) %>% summarise(median_adjusted = median(adjusted_earnings))
state_earnings <- mutate(state_earnings, median_adjusted = 0)
for(i in 1:nrow(with_median)) {
state_earnings$median_adjusted[state_earnings$state == with_median[[i,1]]] <- with_median[[i,2]]
}
state_earnings <- state_earnings %>% arrange(median_adjusted)
adjusted <- ggplot(aes(x = state), data = state_earnings) +
geom_boxplot(aes(y = adjusted_earnings, fill=cbPalette[2]), outlier.shape=NA, coef=0) +
scale_x_discrete(limits=unique(state_earnings$state)) +
guides(fill=FALSE) +
geom_text(data=with_median, aes(x=state, label=state, y=median_adjusted-1500), nudge_x=.1, size=3) +
theme(axis.text.y = element_blank()) +
xlab("State") +
ylab("Adjusted Median Earnings After 10 Years") +
coord_flip(ylim=c(20000,60000))
grid.arrange(unadjusted, adjusted, ncol=1)
test_model <- lm(earnings_debt_ratio ~ tuition.out_of_state, earnings_debt, na.action = na.omit)
summary(test_model)
cor(earnings_debt$earnings_debt_ratio, earnings_debt$tuition.out_of_state, use="complete.obs")
[1]
cor(earnings_debt$earnings_debt_ratio, earnings_debt$tuition.out_of_state, use="complete.obs")^2
correlation_matrix[correlation_matrix[,"X10_yrs_after_entry.median"] > .3, "X10_yrs_after_entry.median"]
correlation_matrix[correlation_matrix[,"X10_yrs_after_entry.median"] < .3, "X10_yrs_after_entry.median"]
enrolled_model <- lm(X10_yrs_after_entry.median ~ title_iv.still_enrolled_by.2yrs, earnings_debt, na.action = na.omit)
salary_model <- lm(X10_yrs_after_entry.median ~ faculty_salary, earnings_debt, na.action = na.omit)
expenditure_model <- lm(X10_yrs_after_entry.median ~ instructional_expenditure_per_fte, earnings_debt, na.action = na.omit)
summary(enrolled_model)
summary(salary_model)
summary(expenditure_model)
summary(enrolled_model)
37578.6/100
both_model <- lm(X10_yrs_after_entry.median ~ faculty_salary + title_iv.still_enrolled_by.2yrs, earnings_debt, na.action = na.omit)
summary(both_model)
cor(earnings_debt$faculty_salary, earnings_debt$title_iv.still_enrolled_by.2yrs, use="complete.obs")
enrolled_salary <- filter(ten_earnings, !is.na(title_iv.still_enrolled_by.2yrs), title_iv.still_enrolled_by.2yrs > 0, !is.na(faculty_salary), faculty_salary > 0)
ggplot(enrolled_salary) +
geom_jitter(aes(x=title_iv.still_enrolled_by.2yrs, y=X10_yrs_after_entry.median))
ggplot(enrolled_salary) +
geom_jitter(aes(x=title_iv.still_enrolled_by.2yrs, y=X10_yrs_after_entry.median)) +
scale_y_continuous(limits=c(15000,75000))
ggplot(enrolled_salary) +
geom_jitter(aes(x=faculty_salary, y=X10_yrs_after_entry.median)) +
scale_y_continuous(limits=c(15000,75000))
ggplot(enrolled_salary_out) +
geom_jitter(aes(x=faculty_salary, y=X10_yrs_after_entry.median)) +
scale_y_continuous(limits=c(15000,75000)) +
geom_hline(xintercept=50000)
ggplot(enrolled_salary) +
geom_jitter(aes(x=faculty_salary, y=X10_yrs_after_entry.median)) +
scale_y_continuous(limits=c(15000,75000)) +
geom_hline(xintercept=50000)
?geom_hline
ggplot(enrolled_salary) +
geom_jitter(aes(x=faculty_salary, y=X10_yrs_after_entry.median)) +
scale_y_continuous(limits=c(15000,75000)) +
geom_hline(aes(xintercept=50000))
ggplot(enrolled_salary) +
geom_jitter(aes(x=faculty_salary, y=X10_yrs_after_entry.median)) +
scale_y_continuous(limits=c(15000,75000)) +
geom_hline(aes(yintercept=50000))
ggplot(enrolled_salary) +
geom_jitter(aes(x=faculty_salary, y=X10_yrs_after_entry.median)) +
scale_y_continuous(limits=c(15000,75000)) +
geom_hline(aes(yintercept=53000))
ggplot(enrolled_salary) +
geom_jitter(aes(x=faculty_salary, y=X10_yrs_after_entry.median)) +
scale_y_continuous(limits=c(15000,75000)) +
geom_hline(aes(yintercept=53000)) +
geom_vline(aes(xintercept=4500))
enrolled_salary_out <- filter(enrolled_salary, faculty_salary < 4500 & X10_yrs_after_entry.median > 53000)
enrolled_salary_in <- filter(enrolled_salary, !(faculty_salary < 4500 & X10_yrs_after_entry.median > 53000)
enrolled_salary_in <- filter(enrolled_salary, !(faculty_salary < 4500 & X10_yrs_after_entry.median > 53000))
enrolled_salary_out
enrolled_salary_out$name
enrolled_salary_in
cor(enrolled_salary_in$faculty_salary, enrolled_salary_in$X10_yrs_after_entry.median)
cor(enrolled_salary$faculty_salary, enrolled_salary$X10_yrs_after_entry.median)
ggplot(enrolled_salary_in) +
geom_jitter(aes(x=faculty_salary, y=X10_yrs_after_entry.median)) +
scale_y_continuous(limits=c(15000,75000)) +
geom_hline(aes(yintercept=53000)) +
geom_vline(aes(xintercept=4500))
enrolled_salary <- filter(enrolled_salary, !grepl("phoenix", ignore.case = TRUE, name))
ggplot(enrolled_salary) +
geom_jitter(aes(x=faculty_salary, y=X10_yrs_after_entry.median)) +
scale_y_continuous(limits=c(15000,75000)) +
geom_hline(aes(yintercept=53000)) +
geom_vline(aes(xintercept=4500))
ggplot(enrolled_salary) +
geom_jitter(aes(x=title_iv.still_enrolled_by.2yrs, y=X10_yrs_after_entry.median, color=as.factor(1))) +
scale_y_continuous(limits=c(15000,75000)) +
scale_color_few()
ggplot(enrolled_salary) +
geom_jitter(aes(x=faculty_salary, y=X10_yrs_after_entry.median, color=as.factor(1))) +
scale_y_continuous(limits=c(15000,75000)) +
scale_color_few() +
guides(color=FALSE)
#title_iv.still_enrolled_by.2yrs
#faculty_salary
enrolled_salary <- filter(ten_earnings, !is.na(title_iv.still_enrolled_by.2yrs), title_iv.still_enrolled_by.2yrs > 0, !is.na(faculty_salary), faculty_salary > 0)
